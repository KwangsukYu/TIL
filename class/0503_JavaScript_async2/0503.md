# 0503 TIL

## Class

 1. **ë‚´ìš© ìš”ì•½**

    1. promise

    2. axios

    3. async, await

    4. ê¸°íƒ€ ë°°ìš´ ë‚´ìš©!

       

 2. **ì˜¤ëŠ˜ ìƒˆë¡­ê²Œ ì•Œê²Œ ëœ ê²ƒ**

    

    1.  Promise

          * callback hellì„ ë²—ì–´ë‚˜ê¸° ìœ„í•´ ë§Œë“¤ì–´ì§„ ë°©ë²•
          * new Promiseë¡œ ì˜¤ë¸Œì íŠ¸ë¥¼ ìƒì„±í•˜ê³  resolveì™€ rejectë¥¼ ì¸ìë¡œ ë°›ìŒ
          * resolve ì„±ê³µ í–ˆì„ ë•Œ!
          * rejcet ì‹¤íŒ¨ í–ˆì„ ë•Œ!
          * then : promise ê°ì²´ê°€ ì„±ê³µì ìœ¼ë¡œ ì‘ë‹µ ë˜ì—ˆì„ë•Œ
          * catch : ì‹¤íŒ¨í–ˆì„ ë•Œ, error í•¸ë“¤ë§ ë¶€ë¶„
          * finally : ì„±ê³µí•˜ë“  ì‹¤íŒ¨í•˜ë“  ì¶œë ¥í•˜ê³  ì‹¶ì„ ë•Œ

         ```javascript
         // 1. Producer
         // when new Promise is created, the executor runs automatically.
         const promise = new Promise((resolve, reject) => {
           // doing some heavy work (network, read files)
           console.log('doing something...')
           setTimeout(() => {
             resolve('name')
             // reject(new Error('no network'))
           }, 2000)
         })
         
         // 2. Consumers: then, catch, finally
         promise
         .then((value) => {
           console.log(value)
         })
         .catch(error => {
           console.log(error)
         })
         .finally(() => {console.log('finally')
         })
         
         // 3. Promise chaining
         const fetchNumber = new Promise((resolve, reject) => {
           setTimeout(() => resolve(1), 1000)
         })
         
         fetchNumber
         .then(num => num * 2)
         .then(num => num * 3)
         .then(num => {
           return new Promise((resolve, reject) => {
             setTimeout(() => resolve(num -1 ), 1000)
           })
         })
         .then(num => console.log(num))
         ```

         * Promiseê°€ ë³´ì¥í•˜ëŠ” ê²ƒ
           * callback í•¨ìˆ˜ëŠ” Call Stackì´ ì™„ë£Œë˜ê¸° ì „ê¹Œì§€ í˜¸ì¶œ ë˜ì§€ ì•ŠìŒ!
           * promise callback í•¨ìˆ˜ëŠ” ìˆœì„œë¥¼ ë³´ì¥
           * .thenì„ ì—¬ëŸ¬ ë²ˆ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ê°œì˜ callback í•¨ìˆ˜ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.
           * chainingì€ Promiseì˜ ê°€ì¥ í° ì¥ì ì„!

    

    2. Axios

       * Promise based HTTP client for the browser and Node.js
       * ë¸Œë¼ìš°ì €ë¥¼ ìœ„í•œ Promise ê¸°ë°˜ì˜ í´ë¼ì´ì–¸íŠ¸
       * ì›ë˜í‹‘ XHRì´ë¼ëŠ” ë¸Œë¼ìš°ì € ë‚´ì¥ ê°ì²´ë¥¼ í™œìš©í•´ì„œ AJAX ìš”ì²­ì„ ì²˜ë¦¬í•˜ì§€ë§Œ í¸ë¦¬í•˜ê²Œ ì²˜ë¦¬ í•  ìˆ˜ ìˆë„ë¡ axiosì—ì„œ ê°„í¸í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì œê³µ
       * ì‚¬ìš©ë²•ì€ axios ê³µì‹ë¬¸ì„œ ì°¸ê³ 

       ```javascript
       // ì´ëŸ°ì‹ìœ¼ë¡œ urlë¶€ë¶„ì„ ì‘ì„±í•´ì„œ ê²°ê³¼ë¥¼ ë°›ì•„ì˜¤ê³  promiseí˜•ì‹ìœ¼ë¡œ ê°€ê³µ ê°€ëŠ¥!
       axios.get('https://source.unsplash.com/1920x1080/')
           .then(res => {
             const imgUrl = res.request.responseURL
             document.body.style.backgroundImage = `url(${imgUrl})`
           })
       
       // ì´ëŸ°ì‹ìœ¼ë¡œ post ìš”ì²­ ë³´ë‚¼ ì‹œ csrf í† í°ë„ ì‚¬ìš©ì´ê°€ëŠ¥
       // ì¥ê³ ë‘ ì—°ê³„í•´ì„œ ì´ìš©ê°€ëŠ¥í•˜ë©° ìì„¸í•œ ë‚´ìš©ì€ ê³µì‹ë¬¸ì„œ ì°¸ê³ !
       // url ì„¤ì •ë²•ì€ ì—¬ëŸ¬ê°€ì§€ ìˆë‹¤!
        const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]').value
        axios.post(`http://127.0.0.1:8000/articles/${articleId}/likes/`, {}, {
            headers: {'X-CSRFToken': csrftoken},
        })
       ```

       

    3. async & await

       * ë¹„ë™ê¸°ê°€ í•„ìš”í•œ ë¶€ë¶„ì— async - await ë¶€ë¶„ì„ ë¶™ì—¬ì„œ ì‚¬ìš©
       * ë™ì‘ì€ promiseì˜  then ì²˜ëŸ¼ ì‘ë™í•œë‹¤!!!

       ```javascript
       // async & await
       // clear style of using promise :)
       
       // 1. async
       async function fetchUser() {
           // do network request in 10 sec...
         return 'h'
       }
       
       const user = fetchUser()
       user.then(console.log)
       console.log(user)
       
       // 2. await
       function delay(ms) {
         return new Promise(resolve => setTimeout(resolve, ms))
       }
       
       async function getApple() {
         await delay(2000)
         return 'ğŸ’•'
       }
       
       async function getBanana() {
         await delay(1000)
         return 'â¤'
       }
       
       
       // 3. useful Promise APIs
       // all, race ë“±ì˜ ë‹¤ì–‘í•œ ê¸°ëŠ¥
       function pickAllFruits() {
         return Promise.all([getApple(), getBanana()])
         .then(fruits => fruits.join(' + '))
       }
       pickAllFruits().then(console.log)
       
       function pickOnlyOne() {
         return Promise.race([getApple(), getBanana()])
       }
       
       pickOnlyOne().then(console.log)
       ```

       

    4.  ì˜¤ëŠ˜ ë°°ìš´ ê¸°ëŠ¥?

       * from íƒœê·¸ì˜ data-id
         * ë°‘ì˜ í˜•ì‹ìœ¼ë¡œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.
         *  const articleId = event.target.dataset.id ë‚˜ì¤‘ì— ìš”ëŸ°ì‹ìœ¼ë¡œ ì¶œë ¥í•´ë³´ì!

       ```html
       <form class="like-form" data-id="{{ article.pk }}">
       ```

       * í´ë˜ìŠ¤ ì†ì„± ë³€ê²½í•˜ê¸°
         * replace ë©”ì„œë“œ ì‚¬ìš©, ë³€ê²½í•˜ê³  ì‹¶ì€ í´ë˜ìŠ¤ë¡œ ë³€ê²½ì‹œí‚¨ë‹¤!

       ```javascript
       likeButton.classList.replace('fa-regular', 'fa-solid')
       ```

       * ì¥ê³  form íƒœê·¸ ë§ê³  JSë¡œ ì‘ë‹µ ë°›ê¸°
         * Jsoní˜•ì‹ ì²˜ëŸ¼ ë§Œë“¤ê³  JsonResponseë¡œ ë„˜ê²¨ì¤Œ
         * ì˜¤ë¥˜ê°™ì€ ê²½ìš°ëŠ” ì•„ë˜ì™€ ë¹„ìŠ·í•˜ê²Œ ì„¤ì •

       ```python
       like_status = {
                   'liked': liked,
                   'count': article.like_users.count(),
               }
               return JsonResponse(like_status)
       
           return HttpResponse(status=401)
       ```

       

       

 3. **ê°ìƒ**

     1. ì‹¤ì œë¡œ ì‚¬ìš©í•´ë³´ë‹ˆ í•  ë§Œ í•œ ê²ƒ ê°™ê¸°ë„?
     1. ì•„ì§ ì œëŒ€ë¡œ ëœ ë¶€ë¶„ì€ ì•„ë‹Œ ê²ƒ ê°™ì•„ì„œ ê±±ì •ì´ê¸´ í•˜ë‹¤.
     1. ê³§ vueì“°ëŠ”ë° í”„ë¡ íŠ¸ ì‹œì‘ì´ë‹¤...
     1. ìŠ¬ìŠ¬ ë­ í•˜ë‚œ í•´ì•¼í•  ê²ƒ ê°™ì€ë°..
